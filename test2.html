<!doctype html>
<html>

    <head>

        <title>Canvas Test</title>
        <style type="text/css">

            img, canvas { 
                float: left;
            }

            h1, p {
                clear: left;
                text-align: center;
                font-family: Lucida Grande;
            }

        </style>
    </head>

    <body onload="go()">

        <div style="width: 960px">
            <h1>Magnitude Map using Simple fast edge detection</h1>
            <p>Taken from the paper written by John Costella at <a href="http://assassinationscience.com/johncostella/edgedetect/">http://assassinationscience.com/johncostella/edgedetect/</a></p>
            <img src="http://danyo.co.uk/stuff/nicky.jpg" />
            <canvas id="test" width="1" height="1">
                <p>well that sucks</p>
            </canvas>
        <p id="result"></p> 
        </div>

        <script src="edge-inline.js"></script>
        <script>

            var image = new Image();
            //image.src = 'http://userserve-ak.last.fm/serve/252/254612.jpg';
            //image.src = 'http://danyo.co.uk/stuff/bob.png';
            //image.src = 'http://userserve-ak.last.fm/serve/252/3614801.jpg';
            //image.src = 'http://userserve-ak.last.fm/serve/252/2162238.jpg';
            //image.src = 'http://userserve-ak.last.fm/serve/252/47493919.png';
            //image.src = 'http://farm5.static.flickr.com/4067/5126215174_f7c556c026_z.jpg';
            //image.src = 'http://assassinationscience.com/johncostella/edgedetect/images/matt.png';
            image.src = "http://danyo.co.uk/stuff/nicky.jpg";
            //image.src = 'http://upload.wikimedia.org/wikipedia/commons/thumb/c/cb/Broadway_tower_edit.jpg/274px-Broadway_tower_edit.jpg'
            //image.src = 'http://upload.wikimedia.org/wikipedia/commons/thumb/c/cb/Broadway_tower_edit.jpg/800px-Broadway_tower_edit.jpg'
            //image.src = 'http://www.dansdata.com/images/blog/rsizr/IMG_9809_1280.jpg'
            //image.src=  'http://www.cs.cmu.edu/afs/andrew/scs/cs/15-463/f07/proj2/www/wwedler/gateway_arch.jpg'
            //image.src = 'http://3.bp.blogspot.com/_h79Be84WZ2U/TECykCpoj_I/AAAAAAAAAGc/Dy1Nw6gbWq8/s800/illaroja.jpg'
            //image.src = 'http://assassinationscience.com/johncostella/edgedetect/images/gray.png'


            var go = function () {
                var start = (new Date()).getTime();
                e = new Edge(image, 'test'); 
                function goV() {
                    e.mapVertical(); 
                }

                function goH() {
                    e.mapHorizontal();
                }

                function goM () {
                    e.mapMagnitude();
                }
                goH();
                goV();
                goM();
                var end = (new Date()).getTime();
                e.context.putImageData(e.magnitudeData, 0,0);
                document.getElementById('result').innerHTML = "Completed in " + ((end - start)/1000) + ' seconds';
            }
        </script>
    </body>

</html>
